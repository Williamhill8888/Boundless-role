#!/bin/bash

echo "ğŸ”’ å¯åŠ¨ Boundless å®‰è£…è„šæœ¬ï¼ˆmacOS å¢å¼ºå®‰å…¨ç‰ˆï¼‰..."

# âš ï¸ å…³é—­å†å²è®°å½•ï¼Œé˜²æ­¢è®°å½•ç§é’¥
set +o history

# ç”¨æˆ·è¾“å…¥ RPC
read -p "ğŸ“¡ è¯·è¾“å…¥ Base ä¸»ç½‘ RPC åœ°å€ï¼ˆå¿…é¡»ä»¥ https:// å¼€å¤´ï¼‰: " RPC_URL
if [[ ! $RPC_URL =~ ^https:// ]]; then
  echo "âŒ é”™è¯¯ï¼šRPC åœ°å€å¿…é¡»ä»¥ https:// å¼€å¤´ï¼"
  exit 1
fi
echo "âœ… ä½ è¾“å…¥çš„ RPC æ˜¯ï¼š$RPC_URL"

# ç”¨æˆ·è¾“å…¥ç§é’¥
read -p "ğŸ” è¯·è¾“å…¥é’±åŒ…ç§é’¥ï¼ˆä¸ä¼šä¿å­˜ï¼‰: " PRIVATE_KEY
echo "ğŸ” ç§é’¥å·²è¯»å–ã€‚"

# æ¢å¤å†å²è®°å½•åŠŸèƒ½
set -o history

echo "âš ï¸ æ³¨æ„ï¼šæœ¬è„šæœ¬ä¸ä¼šä¿å­˜ç§é’¥æˆ– RPC ä¿¡æ¯ï¼Œæ“ä½œå®Œæˆåè¯·æ‰‹åŠ¨å¦¥å–„ä¿ç®¡ï¼"

# å®‰è£… Rust
echo "ğŸ“¦ å®‰è£… Rust..."
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
source "$HOME/.cargo/env"

# å®‰è£… Risc0 å·¥å…·é“¾
echo "ğŸ“¦ å®‰è£… Risc0..."
curl -L https://risczero.com/install | bash
source ~/.zshrc
rzup install

# å…‹éš† Boundless ä»“åº“
echo "ğŸ“‚ å…‹éš† Boundless ä»“åº“..."
git clone https://github.com/boundless-xyz/boundless
cd boundless
git checkout release-0.10

# å®‰è£… bento-client
echo "ğŸ“¦ å®‰è£… bento-client..."
cargo install --git https://github.com/risc0/risc0 bento-client --bin bento_cli

# æ›´æ–° PATHï¼ˆå†™å…¥ .zshrcï¼‰
echo 'export PATH="$HOME/.cargo/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc

# å®‰è£… Boundless CLI
echo "ğŸ“¦ å®‰è£… boundless-cli..."
cargo install --locked boundless-cli

# âœ… ä½¿ç”¨å˜é‡æ‰§è¡Œ CLI å‘½ä»¤
export RPC_URL="$RPC_URL"
export PRIVATE_KEY="$PRIVATE_KEY"

echo "ğŸš€ å¼€å§‹ USDC è´¨æŠ¼ï¼ˆ1 æšï¼‰..."
boundless --rpc-url "$RPC_URL" --private-key "$PRIVATE_KEY" account deposit-stake 1

echo "ğŸš€ å¼€å§‹ ETH å­˜æ¬¾ï¼ˆ0.001 æšï¼‰..."
boundless --rpc-url "$RPC_URL" --private-key "$PRIVATE_KEY" account deposit 0.001

echo "ğŸ‰ æ‰€æœ‰æ“ä½œå·²å®Œæˆï¼ˆæœªä¿å­˜ç§é’¥ï¼‰ï¼è¯·å¦¥å–„ä¿ç®¡ä½ çš„ç§é’¥ã€‚"
